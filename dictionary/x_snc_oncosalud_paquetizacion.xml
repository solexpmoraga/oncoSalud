<?xml version="1.0" encoding="UTF-8"?><database>
    <element label="Paquetizacion" max_length="40" name="x_snc_oncosalud_paquetizacion" type="collection">
        <element display="true" label="Nombre paquete" mandatory="true" max_length="40" name="nombre" type="string"/>
        <element attributes="ignore_filter_on_new=true" default="javascript:global.getNextObjNumberPadded();" label="Numero paquete" max_length="40" name="number" type="string"/>
        <element calculation="(function calculatedFieldValue(current) {&#13;&#10;   var auxTable = 'x_snc_oncosalud_aux_paquetizacion';&#13;&#10;   var tarifarioTable = 'x_snc_oncosalud_tarifario';&#13;&#10;   var tarifario = 'tarifario'; // what do we want to sum up?&#13;&#10;   var precioUnitario = 'precio_unitario';&#13;&#10;   var count = 0;&#13;&#10;&#9;&#13;&#10;   var gr1 = new GlideRecord(auxTable);&#13;&#10;   gr1.addQuery('paquetizacion', current.sys_id);&#13;&#10;   gr1.query();&#13;&#10;   //gs.addInfoMessage('cuenta=' + gr1.getRowCount()); &#13;&#10;   while (gr1.next()) {&#13;&#10;&#9;   //var n = parseInt(gr.getValue(numberField), 10);&#13;&#10;&#9;   var tarifario_id = gr1.getValue('tarifario'); &#13;&#10;&#9;   //gs.addInfoMessage('tarifario_id=' + tarifario_id);&#13;&#10;&#9;   var gr2 = new GlideRecord(tarifarioTable);&#13;&#10;&#9;   gr2.addQuery('sys_id', tarifario_id);&#13;&#10;&#9;   gr2.query();&#13;&#10;&#9;      while (gr2.next()) {&#13;&#10;&#9;         //gr2.next();&#13;&#10;&#9;&#9;&#9; var n2 = parseFloat(gr2.getValue(precioUnitario)); &#13;&#10;&#9;&#9;&#9; count += n2;&#13;&#10;&#9;&#9; }&#13;&#10;   }&#13;&#10;&#13;&#10;   return count;   // return the calculated value&#13;&#10;&#13;&#10;})(current);" label="Total" max_length="15" name="total" read_only="true" type="float" virtual="true"/>
    </element>
</database>
